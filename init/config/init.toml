# RavenLinux Init Configuration
# /etc/raven/init.toml

[system]
# System hostname (can be overridden by /etc/hostname)
hostname = "raven-linux"

# Default runlevel/target
default_runlevel = "default"

# Shutdown timeout in seconds (services have this long to stop)
shutdown_timeout = 10

# Enable automatic kernel module loading
load_modules = true

# Enable udev/eudev for device management
enable_udev = true

# Enable network initialization
enable_network = true

# Log level: trace, debug, info, warn, error
log_level = "info"


# =============================================================================
# Services
# =============================================================================

# tty1: PAM-free rescue shell (avoids /bin/login issues during bring-up)
[[services]]
name = "getty-tty1"
description = "Getty login on tty1"
exec = "/bin/agetty"
args = ["--noclear", "--skip-login", "--login-program", "/bin/raven-rescue", "tty1", "linux"]
tty = "/dev/tty1"
restart = true
enabled = true
critical = false

# tty2: real login prompt (/bin/login + PAM) for testing authentication
[[services]]
name = "getty-tty2"
description = "Getty login on tty2"
exec = "/bin/agetty"
args = ["tty2", "linux"]
tty = "/dev/tty2"
restart = true
enabled = true
critical = false

# Syslog daemon (if available)
[[services]]
name = "syslogd"
description = "System logger"
exec = "/sbin/syslogd"
args = ["-n"]
restart = true
enabled = false  # Enable when syslogd is installed
critical = false

# Kernel log daemon (if available)
[[services]]
name = "klogd"
description = "Kernel logger"
exec = "/sbin/klogd"
args = ["-n"]
restart = true
enabled = false  # Enable when klogd is installed
critical = false

# D-Bus system bus (required for iwd/iwctl and many other services)
[[services]]
name = "dbus"
description = "D-Bus system message bus"
exec = "/usr/bin/dbus-daemon"
args = ["--system", "--nofork", "--nopidfile"]
restart = true
enabled = true
critical = false

# iwd - Modern wireless daemon (requires D-Bus)
[[services]]
name = "iwd"
description = "iNet Wireless Daemon"
exec = "/usr/libexec/iwd"
args = []
restart = true
enabled = true
critical = false

# Network manager (when available)
[[services]]
name = "network"
description = "Network management"
exec = "/bin/raven-dhcp"
args = ["--all", "-q"]
restart = false
enabled = true
critical = false

# PolicyKit authorization daemon (requires D-Bus)
[[services]]
name = "polkitd"
description = "PolicyKit authorization daemon"
exec = "/usr/lib/polkit-1/polkitd"
args = ["--no-debug"]
restart = true
enabled = true
critical = false


# =============================================================================
# Additional mount points (beyond the essential ones)
# =============================================================================

# Example: Mount /home partition
# [[mounts]]
# source = "LABEL=HOME"
# target = "/home"
# fstype = "ext4"
# options = "defaults,noatime"
# mount_at_boot = true

# Example: Mount NFS share
# [[mounts]]
# source = "server:/export/data"
# target = "/mnt/data"
# fstype = "nfs"
# options = "rw,soft"
# mount_at_boot = false
